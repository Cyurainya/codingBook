参考：

https://www.zhihu.com/question/25532384

https://www.cnblogs.com/Survivalist/p/11527949.html

### 进程和线程的区别

最重要的就是:
**进程是资源分配的最小单位，线城是 CPU 调度的最小单位**

其实主要差别在于它们是**不同的操作系统资源管理方式**。**进程有独立的地址空间**，一个进程崩溃后，在保护模式下不会对其他进程产生影响，而**线程只是一个进程中不同的执行路径**。线程有自己的堆栈和局部变量，但线程之间没有独立的地址空间，**一个线程死掉就等于整个进程死掉**。

做个简单的比喻：进程=火车，线城=车厢

- 线程在进程下进行
- 一个进程包含多个线程
- 不同进程间的数据很难共享，同时统一进程下的的数据很容易共享
- 进程要比线程消耗更多的计算机资源
- 进程间不会相互影响，但是一个线程挂掉了整个线程都会挂掉
- 进程可以拓展到多机，但是线程不能
- 进程使用的内存地址可以上锁，就是说一个线程使用某些共享内存的时候，其他线程必须等它结束，才能使用这一块内存。
- 进程使用的内存地址可以限定使用量

所以会产生如下结果：

1. 线程产生的速度块，通讯快，切换快，因为他们处于同一个地址空间
2. 线程的资源利用率好
3. 线程使用公共变量或内存的时候需要同步机制，但进程不用
4. 一个程序至少有一个进程，一个进程至少有一个线程。
5. 线程的划分尺度小于进程，使得多线程程序的并发性高。
6. 进程在执行过程中拥有读理的内存单位，而多个线程共享内存，从而极大地提高了程序地运行效率
7. **线程不能够独立运行**

## 进程

> 进程是一个具有一定独立功能的程序在一个数据集上的一次动态执行的过程，是操作系统进行资源分配和任务调度的一个独立单位，是应用程序运行的载体。进程是一种抽象的概念，从来没有统一的标准定义。

进程一般由**程序、数据集合和程序控制块**三部分组成

- 程序用于描述进程要完成的功能，是控制进程执行的指令集
- 数据集合是程序在执行时所需要的数据和工作区
- 程序控制块包含进程的描述信息和控制信息，是进程存在的唯一标识

#### 特征

- **动态性:** 进程是程序一次的执行过程，是临时的，是有生命期的，是动态产生，动态消亡。
- **并发性:** 任何进程都可以同其他进程一起并发执行
- **独立性：** 晋城市系统进行资源分配和调度的一个独立单位
- **结构性:** 进程由程序、数据和进程控制块三部分组成。

## 线程

> 是程序执行流的最小单位，是处理调度和分派的基本单位，各个线程之间共享程序的内存空间

一、 进程通讯

##### 管道(pipe):

管道是一种半双工的通信方式，数据只能单向流动，而且只能在具有亲缘关系的进程间使用。进程的亲缘关系通常是指父子进程关系

#### 有名管道：

有名管道也是半双工的通信方式，但是它允许无亲缘关系进程间的通信

#### 信号量

信号量是一个计数器，可以用来==控制多个进程对共享资源的访问==。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。

#### 消息队列

消息队列是由消息的链表，存放在内核中并由消息队列标识符标识。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。

#### 信号

信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生

#### 共享内存

共享内存就是映射一段能被其他进程所访问的内存。这段共享内存由==一个进程==创建，但多个进程都可以访问。==共享内存是最快的 IPC 方式==，它是针对其他进程间通信方式运行效率低而专门设计的。它往往与其他通信机制，如信号量，配合使用，来实现进程间的同步和通信。

#### 套接字：

套接口也是一种进程间的通信机制，与其他通信机制不同的是，它可用于不同设备及其间的进程通信。

## 任务调度

在一个进程中，当一个线程任务执行几毫秒后，会由操作系统的内核（负责管理各个任务）进行调度，通过硬件的计数器中断处理器，让该线程强制暂停并将该线程的寄存器放入内存中，通过查看线程列表决定接下来执行哪一个线程，并从内存中恢复该线程的寄存器，最后恢复该线程的执行，从而去执行下一个任务。
上述过程中，任务执行的那一小段时间叫做时间片，任务正在执行时的状态叫运行状态，被暂停的线程任务状态叫做就绪状态，意为等待下一个属于它的时间片的到来。
